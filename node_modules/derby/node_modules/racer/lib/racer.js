// Generated by CoffeeScript 1.3.1
var EventEmitter, isServer, mergeAll, plugin, racer, util, _ref;

_ref = util = require('./util'), mergeAll = _ref.mergeAll, isServer = _ref.isServer;

if (!isServer) {
  require('es5-shim');
}

EventEmitter = require('events').EventEmitter;

plugin = require('./plugin');

racer = module.exports = new EventEmitter;

mergeAll(racer, plugin, {
  "protected": {
    Model: require('./Model')
  },
  util: util
});

if (isServer) {
  racer.use(__dirname + '/racer.server');
}

racer.use(require('./mutators')).use(require('./refs')).use(require('./pubSub')).use(require('./txns'));

if (isServer) {
  racer.use(__dirname + '/adapters/pubsub-memory');
}

if (!isServer) {
  racer.use(require('./racer.browser'));
}
